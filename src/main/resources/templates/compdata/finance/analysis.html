<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('财务分析')" />
</head>
<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
    <form role="form">
        <div class="form-group">
            <!-- type:"",site:"",principal:"" -->
            <label for="type" style="width: 100px;display: inline;">选择型号</label>
            <select class="form-control" style="width: 100px;display: inline;" id="type">
                <option value="">所有</option>
<!--                <option th:each="item,itemStat : ${typeList}" th:text="${item}" th:value="${item}"></option>-->
            </select>
            <label for="site" style="width: 100px;display: inline;">选择站点</label>
            <select class="form-control" style="width: 100px;display: inline;" id="site">
                <option value="">所有</option>
<!--                <option th:each="item,itemStat : ${typeList}" th:text="${item}" th:value="${item}"></option>-->
            </select>
            <label for="principal" style="width: 100px;display: inline;">选择负责人</label>
            <select class="form-control" style="width: 100px;display: inline;" id="principal">
                <option value="">所有</option>
                <!--                <option th:each="item,itemStat : ${typeList}" th:text="${item}" th:value="${item}"></option>-->
            </select>
            <button type="button" class="btn btn-w-m btn-success" onclick="resetConditionAndRefresh()">重置条件</button>
        </div>
    </form>

    <!--row1-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalGrossProfits"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="advertisingFeeRates"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- row2 -->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalAdvertisingFees"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalSalesRevenues-totalCompensations"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- row3 -->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalSalesRevenues"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="price"></div>
                </div>
            </div>
        </div>
    </div>


    <!--row4-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalCompensations-compensationRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalFinalFreight2s-finalFreight2Rates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row5-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalPackagingFees-packagingRages"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalPromotionFees-promotionFeeRates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row6-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalPlatformRefunds-platformRefundRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalFinalFreightReturn2s-finalFreightReturn2Rates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row7-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalOtherFees-otherFeeRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalMixedVats-mixedVatRates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row8-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalSelfdeliveryCommissions-selfdeliveryCommissionRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalFbaSalesCommissions-fbaSalesCommissionRates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row9-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalFinalFreightReturns-finalFreightReturnRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalOtherTransactionFees-otherTransactionFeeRates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row10-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalStorageFees-storageFeeRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalShippingLabelFees-shippingLabelFeeRates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row11-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalPlaformServiceFees-plaformServiceFeeRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalPlatformRefundServiceFees-platformRefundServiceFeeRates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row12-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalPlatformServiceAdjustmentFees-platformServiceAdjustmentFeeRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalMixedVat2s-mixedVat2Rates"></div>
                </div>
            </div>
        </div>
    </div>

    <!--row13-->
    <div class="row">
        <!--1-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">

                    <div class="echarts" id="totalClearBrokerFees-clearBrokerFeeRates"></div>
                </div>
            </div>
        </div>
        <!--2-->
        <div class="col-sm-6">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="echarts" id="totalServiceProviderFees-serviceProviderFeeRates"></div>
                </div>
            </div>
        </div>
    </div>



</div>
<th:block th:include="include :: footer" />
<th:block th:include="include :: echarts-js" />
<script type="text/javascript">
    var analysis_url = "/compdata/finance/getAnalysisData";
    var searchObj = {type:"",site:"",principal:""};//搜索条件对象
    var changeSelect = "";
    var bWidth = 30;//柱图宽度
    $(function () {
        init_echarts();
        init_searchArea();
        monitor_searchArea();

    });
    function monitor_searchArea(){
        $("#type").change(function(){
            //type = $("#type option:selected").val();
            searchObj.type = $("#type option:selected").val();
            changeSelect = this.id;
            init_searchArea();
            init_echarts();
        });
        $("#site").change(function(){
            //type = $("#type option:selected").val();
            searchObj.site = $("#site option:selected").val();
            changeSelect = this.id;
            init_searchArea();
            init_echarts();
        });
        $("#principal").change(function(){
            //type = $("#type option:selected").val();
            searchObj.principal = $("#principal option:selected").val();
            changeSelect = this.id;

            init_searchArea();
            init_echarts();
        });

    }

    //构建搜索参数
    function buildCondition(){
        searchObj = {type:"",site:"",principal:""};
        searchObj.type = $("#type option:selected").val();
        searchObj.site = $("#site option:selected").val();
        searchObj.principal = $("#principal option:selected").val();
    }

    function buildCondition4InitSearchArea(){
        searchObj = {type:"",site:"",principal:""};
        searchObj.type = $("#type option:selected").val();
        searchObj.site = $("#site option:selected").val();
        searchObj.principal = $("#principal option:selected").val();
        console.log("param:"+searchObj);
    }

    function init_searchArea(){
        buildCondition4InitSearchArea();
        console.log("searchObj:"+searchObj);
        $.ajax({
            url : "/compdata/finance/getAnalySearch",
            type : "GET",
            dataType : "JSON",
            data: searchObj,
            success : function(res) {
                var types = res.data.types;
                var sites = res.data.sites;
                var principals = res.data.principals;;
                console.log("res.data:"+res.data);

                    $("#type").html('<option value="">所有</option>');
                    $.each(types,function(index,value){
                        var selectSatus = '';
                        if(value==searchObj.type) selectSatus = 'selected  =  "selected"';
                        $("#type").append('<option '+selectSatus+' value="'+value+'">'+value+'</option>');
                    });

                    $("#site").html('<option value="">所有</option>');
                    $.each(sites,function(index,value){
                        var selectSatus = '';
                        if(value==searchObj.site) selectSatus = 'selected  =  "selected"';
                        $("#site").append('<option '+selectSatus+' value="'+value+'">'+value+'</option>');
                    });


                    $("#principal").html('<option value="">所有</option>');
                    $.each(principals,function(index,value){
                        var selectSatus = '';
                        if(value==searchObj.principal) selectSatus = 'selected  =  "selected"';
                        $("#principal").append('<option '+selectSatus+'  value="'+value+'">'+value+'</option>');
                    });

            },
            error : function(errorMsg) {
                layer.msg('服务器开了点小差，请稍后刷新页面!', {icon: 0});
                myChart.hideLoading();
            }
        });
    }

    function init_echarts(){
        buildCondition();
        $.ajax({
            url : analysis_url,
            type : "GET",
            dataType : "JSON",
            // data: {
            //     type: searchObj.type
            // },
            data:  searchObj,
            success : function(res) {
                var data = res.data;
                var months = data.months;
                //init_chart(months,data.totalGrossProfits,"totalGrossProfits", "财务报表毛利和环比",'',"#62d1de","bar");
                init_chartW2W2Y(months,[data.totalGrossProfits,data.grossProfitGRs],"totalGrossProfits",
                    "财务报表毛利和环比",["财务报表毛利","环比"],["#62d1de","#DC143C"],["bar","line"],[-1,0.1],["","%"],["","%"]);
                //init_chart(months,data.advertisingFeeRates,"advertisingFeeRates", "广告费占比(ACoAS)和环比",'',"#62d1de","bar");
                init_chartW2W2Y(months,[data.advertisingFeeRates,data.advertisingFeeRateGRs],"advertisingFeeRates",
                    "广告费占比(ACoAS)和环比",["广告费占比(ACoAS)","环比"],["#62d1de","#DC143C"],["bar","line"],[-1,0.1],["%","%"],["%","%"]);
                init_chart(months,data.totalAdvertisingFees,"totalAdvertisingFees", "广告花费",'',"#62d1de","bar");
                //xData,yData,echartId,title,legend,color,echartType
                init_chartWith2(months,[data.totalAsinkingNums,data.tatalYcDeliveryNums],"totalSalesRevenues-totalCompensations",
                    "AsinKing数量和易仓出货量",["AsinKing数量","易仓出货量"],["#62d1de","#dc143c"],["bar","bar"]);
                init_chart(months,data.totalSalesRevenues,"totalSalesRevenues","销售收入(含自配送）","","#62d1de","line",-1);
                init_chart(months,data.prices,"price","单价","","#62d1de","line",1);
                init_chartW2W2Y(months,[data.totalCompensations,data.compensationRates],"totalCompensations-compensationRates",
                    "赔偿金和占比",["赔偿金","赔偿金占比"],["#62d1de","#DC143C"],["line","line"],[-1,0.1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalFinalFreights,data.finalFreightRates],"totalFinalFreight2s-finalFreight2Rates",
                    "尾程运费信用和占比",["尾程运费信用","尾程运费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalPackagingFees,data.packagingRages],"totalPackagingFees-packagingRages",
                    "包装费和占比",["包装费","包装费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalPromotionFees,data.promotionFeeRates],"totalPromotionFees-promotionFeeRates",
                    "促销费和占比",["促销费","促销费占比"],["#62d1de","#DC143C"],["bar","line"],[-1,0.01],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalPlatformRefunds,data.platformRefundRates],"totalPlatformRefunds-platformRefundRates",
                    "平台退款和占比",["平台退款","平台退款占比"],["#62d1de","#DC143C"],["bar","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalFinalFreightReturn2s,data.finalFreightReturn2Rates],"totalFinalFreightReturn2s-finalFreightReturn2Rates",
                    "尾程运费退回和占比",["尾程运费退回","尾程运费退回占比"],["#62d1de","#DC143C"],["bar","line"],[-1,0.001],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalOtherFees,data.otherFeeRates],"totalOtherFees-otherFeeRates",
                    "其他和占比",["其他","其他占比"],["#62d1de","#DC143C"],["bar","line"],[-1,0.01],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalMixedVats,data.mixedVatRates],"totalMixedVats-mixedVatRates",
                    "17, 18 混合增值税和占比",["17, 18 混合增值税","17, 18 混合增值税占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"])
                init_chartW2W2Y(months,[data.totalSelfdeliveryCommissions,data.selfdeliveryCommissionRates],"totalSelfdeliveryCommissions-selfdeliveryCommissionRates",
                    "自配送销售佣金和占比",["自配送销售佣金","自配送销售佣金占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalFbaSalesCommissions,data.fbaSalesCommissionRates],"totalFbaSalesCommissions-fbaSalesCommissionRates",
                    "FBA销售佣金和占比",["FBA销售佣金","FBA销售佣金占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalFinalFreightReturns,data.finalFreightReturnRates],"totalFinalFreightReturns-finalFreightReturnRates",
                    "尾程运费退回（N6+T6+AG6)和占比",["尾程运费退回（N6+T6+AG6)","尾程运费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalOtherTransactionFees,data.otherTransactionFeeRates],"totalOtherTransactionFees-otherTransactionFeeRates",
                    "其他交易费和占比",["其他交易费","其他交易费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalStorageFees,data.storageFeeRates],"totalStorageFees-storageFeeRates",
                    "仓储费和占比",["仓储费","仓储费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalShippingLabelFees,data.shippingLabelFeeRates],"totalShippingLabelFees-shippingLabelFeeRates",
                    "运输标签费和占比",["运输标签费","运输标签费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalPlaformServiceFees,data.plaformServiceFeeRates],"totalPlaformServiceFees-plaformServiceFeeRates",
                    "平台服务费和占比",["平台服务费","平台服务费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalPlatformRefundServiceFees,data.platformRefundServiceFeeRates],"totalPlatformRefundServiceFees-platformRefundServiceFeeRates",
                    "平台退款服务费和占比",["平台退款服务费","平台退款服务费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalPlatformServiceAdjustmentFees,data.platformServiceAdjustmentFeeRates],"totalPlatformServiceAdjustmentFees-platformServiceAdjustmentFeeRates",
                    "平台服务调整费和占比",["平台服务调整费","平台服务调整费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalMixedVat2s,data.mixedVat2Rates],"totalMixedVat2s-mixedVat2Rates",
                    "34 35 混合增值税和占比",["34 35 混合增值税","34 35 混合增值税占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalClearBrokerFees,data.clearBrokerFeeRates],"totalClearBrokerFees-clearBrokerFeeRates",
                    "清算经纪费和占比",["清算经纪费","清算经纪费占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);
                init_chartW2W2Y(months,[data.totalServiceProviderFees,data.serviceProviderFeeRates],"totalServiceProviderFees-serviceProviderFeeRates",
                    "服务商费用和占比",["服务商费用","服务商费用占比"],["#62d1de","#DC143C"],["line","line"],[-1,-1],["","%"],["","%"]);

            },
            error : function(errorMsg) {
                console.log("errorMsg:"+errorMsg);
                layer.msg('服务器开了点小差，请稍后刷新页面!', {icon: 0});
                myChart.hideLoading();
            }
        });
        //searchObj = {type:"",storeCode:"",asin:"",sku:"",changeSelect:""};
    };

    function resetConditionAndRefresh(){
        // changeSelect = "";
        // init_echarts();
        // init_searchArea();
        window.location.reload();
    }
    function  init_chart(xData,yData,echartId,title,legend,color,echartType,rangeFloorNum){
        var barChart = echarts.init(document.getElementById(echartId));
        var baroption = {
            title: {
                text: title
            },
            // tooltip: {
            //     trigger: 'axis'
            // },
            tooltip: {
                trigger: 'item',
                formatter: function(params) {

                  return toolTip(params,yData);
                }
            },
            legend: {
                data: legend
            },
            grid: {
                x: 30,
                x2: 40,
                y2: 24,
                containLabel: true
            },
            calculable: true,
            xAxis: [
                {
                    type: 'category',
                    data: xData
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    min: function(value) {
                       return mixValue(value,rangeFloorNum);
                    },
                }
            ],
            color:color,
            series: [
                {
                    name: legend,
                    type: echartType,
                    data: yData,
                    itemStyle : { normal: {label : {show: true}}},
                    barWidth: bWidth,//柱状图长度
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            textStyle: {
                                color: 'black'
                            }
                        }
                    },

                }
            ]
        };
        barChart.setOption(baroption);

        window.onresize = barChart.resize;

    }

    function  init_chartWith2(xData,yData,echartId,title,legend,color,echartType){
        var barChart = echarts.init(document.getElementById(echartId));
        var baroption = {
            title: {
                text: title
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: legend
            },
            grid: {
                x: 30,
                x2: 40,
                y2: 24,
                containLabel: true
            },
            calculable: true,
            xAxis: [
                {
                    type: 'category',
                    data: xData
                }
            ],
            yAxis: [
                {
                    //name: legend,
                    type: 'value'
                }
            ],
            color:color,
            series: [
                {
                    name: legend[0],
                    type: echartType[0],
                    data: yData[0],
                    itemStyle : { normal: {label : {show: true}}},
                    barWidth: bWidth,//柱状图长度
                    yAxisIndex: 0,
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            textStyle: {
                                color: 'black'
                            }
                        }
                    },

                },{
                    name: legend[1],
                    type: echartType[1],
                    data: yData[1],
                    itemStyle : { normal: {label : {show: true}}},
                    barWidth: bWidth,//柱状图长度
                    yAxisIndex: 0,
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            textStyle: {
                                color: 'black'
                            }
                        }
                    },

                }
            ]
        };
        barChart.setOption(baroption);

        window.onresize = barChart.resize;

    }

    function  init_chartW2W2Y(xData,yData,echartId,title,legend,color,echartType,rangeFloorNum,xFm,yFm){
        yFm = yFm==undefined?["",""]:yFm;
        yFm[0] = yFm[0]==undefined?"":yFm[0];
        yFm[1] = yFm[1]==undefined?"":yFm[1];
        xFm = xFm==undefined?["",""]:xFm;
        xFm[0] = xFm[0]==undefined?"":xFm[0];
        xFm[1] = xFm[1]==undefined?"":xFm[1];
        var barChart = echarts.init(document.getElementById(echartId));
        var baroption = {
            title: {
                text: title
            },
            backgroundColor: 'white',
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: legend
            },
            grid: {
                x: 30,
                x2: 40,
                y2: 24,
                containLabel: true
            },
            calculable: true,
            xAxis: [
                {
                    type: 'category',
                    data: xData
                }
            ],
            yAxis: [
                {
                    //name: legend[0],
                    type: 'value',
                    axisLabel: {
                        formatter: '{value}'+xFm[0]
                    },
                    min: function(value) {
                        return mixValue(value,rangeFloorNum[0]);
                    },
                },
                {
                    //name: legend[1],
                    type: 'value',
                    axisLabel: {
                        formatter: '{value}'+xFm[1]
                    },
                    min: function(value) {
                        return mixValue(value,rangeFloorNum[1]);
                    },
                }
            ],
            color:color,
            series: [
                {
                    name: legend[0],
                    type: echartType[0],
                    data: yData[0],
                    itemStyle : {
                        normal: {
                            label : {
                                show: true,
                                formatter: '{c}'+yFm[0],
                            }
                        }
                    },
                    barWidth: bWidth,//柱状图长度
                    yAxisIndex: 0,
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            textStyle: {
                                color: 'black'
                            }
                        }
                    },

                },{
                    name: legend[1],
                    type: echartType[1],
                    data: yData[1],
                    itemStyle : {
                        normal: {
                            label : {
                                show: true,
                                formatter: '{c}'+yFm[1],
                            }
                        }
                        },
                    barWidth: bWidth,//柱状图长度
                    yAxisIndex: 1,
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            textStyle: {
                                color: 'black'
                            }
                        }
                    },

                }
            ]
        };
        barChart.setOption(baroption);

        window.onresize = barChart.resize;

    }

    function mixValue(value,rangeFloorNum) {
        //if(rangeFloorNum==2) alert(Math.floor(value.min));
        if(rangeFloorNum==-1||rangeFloorNum==undefined||value.min==0) return 0;
        else return value.min - rangeFloorNum;
    }

    function toolTip(params,data){
        // 先拼接当期数值，以及 '，环比增长' 文字
        relVal = params.data;
        gap = params.data - data[params.dataIndex - 1];
        // 再拼接环比增长率及百分号，或者 '未知' 文字
        relVal += params.dataIndex === 0 ? '' : ",增长值为："+gap+"，环比增长"+((gap * 100) / data[params.dataIndex - 1]).toFixed(2) + '%';
        return relVal;
    }
</script>
</body>
</html>